# 인사이드 자바스크립트

### 실행 컨텍스트

실행 컨텍스트의 정의는 _**실행 가능한 코드를 형상화하고 구분하는 추상적인 개념**이다. 
풀어서 말하면 **실행 가능한 자바스크립트 코드 블록이 실행되는 환경**이라고 할 수 있다.

실행 컨텍스트가 생성되는 경우는 전역 코드, eval() 함수로 실행되는 코드, 함수 안의 코드를 실행하는 경우이다.
ECMAScript에서는 실행 컨텍스트의 생성을 **현재 실행되는 컨텍스트에서 이 컨텍스트와 관련 없는 실행 코드가 실행되면, 
새로운 컨텍스트가 생성되어 스택에 들어가고 제어권이 그 컨텍스트로 이동한다**라고 설명한다.

- 실행 컨텍스트 생성 과정
    1. 활성 객체 생성 : 엔진에서 컨텍스트 실행에 필요한 정보를 담을 객체를 생성 (= 활성 객체 or 변수 객체)
    2. arguments 객체 생성 
    3. 스코프 정보 생성 : 해당 컨텍스트 유효범위를 나타내는 정보를 생성 (스코프 체인 생성 [[scope]])
    4. 변수 생성 : 실행 컨텍스트 내부에서 사용되는 지역 변수의 생성 (함수도 포함)
    5. this 바인딩 : this 키워드를 사용하는 값이 할당 됨, this가 참조 객체가 없을 경우 전역 객체 참조
    6. 코드 실행 : 이 과정에서 값이 할당 됨.
    
    > 전역 실행 컨텍스트는 arguments 객체가 없으며 전역 객체 하나만을 포함하는 스코프 체인이 있다.

- 스코프 체인  
    자바스크립트는 구문(ex. for(), {}, if{}) 유효 범위가 없다. 오직 함수만이 유효범위의 한 단위가 된다. 
    이 유효 범위를 나타내는 스코프가 [[scope]] 프로퍼티로 각 함수 객체 내에서 연결 리스트 형식으로 관리되는데, 이를 **_스코프 체인_**이라고 한다.

    |  |  |
    |------- | ------- |
    3 | .... |
    2 | 변수 객체 2 |
    1 | 변수 객체 1 |
    0 | 변수 객체 0 |

    + 각 함수 객체는 [[scope]] 프로퍼티로 현재 컨텍스트의 스코프 체인을 참조한다.
    + 함수 실행시 새로운 실행 컨텍스트는 현재 실행되는 함수 객체의 [[scope]] 프로퍼티를 복사하고,  
        새롭게 생성된 변수 객체를 해당 체인의 제일 앞(=위)에 추가한다.
    + **스코프 체인 = 현재 실행 컨텍스트 변수 객체 + 상위 컨텍스트의 스코프 체인**

    > 스코프 체인에서 변수를 찾는 행위를 식별자 인식(Identifier resolution)이라고 한다.
    > 식별자 인식은 체인의 첫번째 변수 객체부터 시작해 대응되는 이름을 가진 프로퍼티를 확인한다.  
    > ES5,6에서는 outer를 참조를 통해 식별자를 찾는다. ([자바스크립트 코드의 실행](http://byron1st.pe.kr/?p=367))


